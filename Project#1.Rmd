---
title: "Project#1"
author: "Nathan Robinson, ..."
date: "02/19/2020"
output: pdf_document
---

# Regression

This is a group project, and students should work in a group of size 3. Include all the R code, hypothesis testing, one or two lines of explanation for any output. The report should be organized, printed, and stapled. The due date of this project is $\textbf{Wednesday } 02/19/2020.$ 

```{r}
Movies = read.csv("C3 2008Movies.csv")
```

The 2008Movies file contains data on movies released in 2008.

1. Calculate a regression model to predict box office from run time. Interpret the $R^2$ value and test statistic for the slope in the context of this problem.

```{r}
M1 = lm(BoxOfficeGross~RunTime, data=Movies)
summary(M1)

plot(resid(M1))

qqnorm(resid(M1))
qqline(resid(M1))
```


2. Create indicator variables for the genre and MPAA rating. Use the best subsets regression to determine a appropriate regression model.  

```{r}
Genre1 = as.numeric(Movies$Genre)
MPAA = as.numeric(Movies$MPAA)

library("leaps")
Model_subset = regsubsets(BoxOfficeGross~Genre + MPAA, data=Movies)
summary(Model_subset)

# We want row 8
# GenreComedy + GenreConcert/Performance + GenreDocumentary + GenreDrama + GenreHorror + GenreRomantic Comedy + GenreThriller/Suspense + MPAAR

Comedy = as.numeric(Movies$Genre == "Comedy")
Concert = as.numeric(Movies$Genre == "Concert/Performance")
Documentary = as.numeric(Movies$Genre == "Documentary")
Drama = as.numeric(Movies$Genre == "Drama")
Horror = as.numeric(Movies$Genre == "Horror")
RomCom = as.numeric(Movies$Genre == "Romantic Comedy")
Thriller = as.numeric(Movies$Genre == "Thriller/Suspense")
MPAAR = as.numeric(Movies$MPAA == "R")

Model_full= lm(BoxOfficeGross~Comedy  + Documentary + Drama + Horror + RomCom + Thriller + MPAAR, data=Movies)
summary(Model_full)

Model_best = lm(BoxOfficeGross~Comedy  + Documentary + Drama + Thriller + MPAAR, data=Movies)
summary(Model_best)

genreslist = cbind(cbind(cbind(Comedy, Documentary), Drama), Thriller)
Movies = cbind(cbind(Movies, genreslist), MPAAR)

# plot(predict(Model_best))
# plot(resid(Model_best))
```
a. Validate the model assumptions.  
    \indent There is a linear relationship.  By examining the coefficient of determination, it can be seen that there is no linear relationship.  
    \indent Multivariate normality.  
    ```{r}
    boxplot(Movies$BoxOfficeGross~Movies$Genre)
    boxplot(Movies$BoxOfficeGross~Movies$MPAA)
    ```
    By examining the boxplots, it can be seen that there is not multivariate normality.  
    \indent Little or no multicolinearity  
    ```{r}
    library(mctest)
    imcdata = data.matrix(Movies[19:23])
    imcdiag(x = imcdata, y = Movies$BoxOfficeGross)
    ```
    Given the F-G test, GenreComedy, GenreDrama, and GenreThriller/Suspense are all sources of multicollinearity.  
    \indent Variance of error terms are similar.  
    ```{r}
    plot(residuals(Model_best)~predict(Model_best))
    abline(lm(residuals(Model_best)~predict(Model_best)))
    ```
    Given a plot of residuals vs predicted values, it appears that the error terms are similar and variance is not affected by how large a predicted value is.  

b. Look at residual plots and check for heteroskedasticity (unequal variance), multicollinearity, correlation of errors, and outliers. Transform the data if it is appropriate.  
    ```{r}
    plot(Model_best)
    summary(lm(residuals(Model_best)~predict(Model_best)))
    boxplot(residuals(Model_best))
    ```
    \indent Heteroskedasticity: It was found in part a that the variance is equal, and the Residual vs. Fitted plot further shows that this is true.  
    \indent Multicollinearity: It was found in part a that there are some terms which cause multicollinearity, further shown in the residual plots.  
    \indent Correlation of Errors: It was found that there is no correlation for errors, given the summary statistics for the linear model for residuals vs. predicted values.  
    \indent Outliers: Given the boxplot, it appears that there are quite a few outliers in the data in terms of residuals.  
    \indent Transformation: Given that the independent variables in this case were all 0 or 1, it was found that most transformations would yield little to no result.  

c. submit your suggested least squares regression formula along with a limited number of appropriate graphs that provide justification for your model. Describe why you believe this model is the best.  
    
$$BoxOfficeGross = 82953286 -23261221 (Comedy) -53919296 (Documentary) -40706552 (Drama) -31181374 (Thriller) + -22013000 (MPAAR)$$

    d. Test the overall model adequacy. 

3. Conduct an extra sum of squares test to determine if one or more interaction terms (or quadratic terms) should be included in the model. You can choose any other terms to test.

4. Test whether average run time is the same for different Genre. Clearly show your hypothesis test.
\vskip 1ex
Using $H_0: \mu_1 = \mu_2 = \mu_3 = \mu_4 = \mu_5 = \mu_6 = \mu_7 = \mu_8 = \mu_9 = \mu_{10}$ and $H_a: \mu_i$ are not all equal.
```{r}
summary(aov(RunTime~Genre, data = Movies))
```
With a p-value of $5.51\times10^{-12}$ we have suffecint evidence to reject the null hypothesis and conclude that the average runtime for differnet movie genres is not the same.

5. Check equality of variance of run time for Genre type.
\vskip 1ex
Using Barlett's test with $H_0: \sigma^2_1 = \sigma^2_2 = \sigma^2_3 = \sigma^2_4 = \sigma^2_5 = \sigma^2_6 = \sigma^2_7 = \sigma^2_8 = \sigma^2_9$ and $H_a: \sigma^2_i$ are not all equal.
```{r}
Movies2 = Movies[-8,] # We must ommit the western movie because it is the only oberservation
bartlett.test(RunTime~Genre, data = Movies2)
```
With a p-value of $2.967\times10^{-7}$ we have suffecint evidence to reject the null hypothesis and conclude that the varience in runtime for differnet movie genres is not the same. 
